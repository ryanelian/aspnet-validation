!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.aspnetValidation=e():t.aspnetValidation=e()}(this,function(){return function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var r={};return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),r.d(e,"MvcValidationProviders",function(){return a}),r.d(e,"ValidationService",function(){return o});var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(i,a){function o(t){try{u(n.next(t))}catch(t){a(t)}}function s(t){try{u(n.throw(t))}catch(t){a(t)}}function u(t){t.done?i(t.value):new r(function(e){e(t.value)}).then(o,s)}u((n=n.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){function r(t){return function(e){return n([t,e])}}function n(r){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,a&&(o=a[2&r[0]?"return":r[0]?"throw":"next"])&&!(o=o.call(a,r[1])).done)return o;switch(a=0,o&&(r=[0,o.value]),r[0]){case 0:case 1:o=r;break;case 4:return u.label++,{value:r[1],done:!1};case 5:u.label++,a=r[1],r=[0];continue;case 7:r=u.ops.pop(),u.trys.pop();continue;default:if(o=u.trys,!(o=o.length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){u=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){u.label=r[1];break}if(6===r[0]&&u.label<o[1]){u.label=o[1],o=r;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(r);break}o[2]&&u.ops.pop(),u.trys.pop();continue}r=e.call(t,u)}catch(t){r=[6,t],a=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var i,a,o,s,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},a=function(){function t(){this.required=function(t,e,r){return Boolean(t)},this.stringLength=function(t,e,r){if(!t)return!0;if(r.min){var n=parseInt(r.min);if(t.length<n)return!1}if(r.max){var i=parseInt(r.max);if(t.length>i)return!1}return!0},this.compare=function(t,e,r){if(!r.other)return!0;var n=document.getElementById(r.other.substr(2));return!n||n.value===t},this.range=function(t,e,r){if(!t)return!0;var n=parseFloat(t);if(isNaN(n))return!1;if(r.min){if(n<parseFloat(r.min))return!1}if(r.max){if(n>parseFloat(r.max))return!1}return!0},this.regex=function(t,e,r){return!t||!r.pattern||new RegExp(r.pattern).test(t)},this.email=function(t,e,r){return!t||/^([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22))*\x40([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d))*(\.\w{2,})+$/.test(t)},this.creditcard=function(t,e,r){if(!t)return!0;if(/[^0-9 \-]+/.test(t))return!1;var n,i,a=0,o=0,s=!1;if(t=t.replace(/\D/g,""),t.length<13||t.length>19)return!1;for(n=t.length-1;n>=0;n--)i=t.charAt(n),o=parseInt(i,10),s&&(o*=2)>9&&(o-=9),a+=o,s=!s;return a%10==0},this.url=function(t,e,r){return!t||new RegExp("^(?:(?:https?|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))\\.?)(?::\\d{2,5})?(?:[/?#]\\S*)?$","i").test(t)},this.phone=function(t,e,r){return!t||!/[\+\-\s][\-\s]/g.test(t)&&/^\+?[0-9\-\s]+$/.test(t)},this.remote=function(t,e,r){return!t||new Promise(function(n,i){for(var a=r.url+"?"+e.name+"="+encodeURIComponent(t),o=r.additionalfields.split(","),s=0;s<o.length;s++){var u=o[s].substr(2);if(u!==e.name){var d=document.getElementById(u);d&&d.value&&(a=a+"&"+d.name+"="+encodeURIComponent(d.value))}}var f=new XMLHttpRequest;f.open("get",a),f.onload=function(t){if(f.status>=200&&f.status<300){var e=JSON.parse(f.responseText);n(e)}else i({status:f.status,statusText:f.statusText,data:f.responseText})},f.onerror=function(t){i({status:f.status,statusText:f.statusText,data:f.responseText})},f.send()})}}return t}(),o=function(){function t(){this.providers={},this.messageFor={},this.elementUIDs=[],this.formInputs={},this.validators={},this.elementEvents={},this.summary={},this.debounce=300}return t.prototype.addProvider=function(t,e){this.providers[t]||(this.providers[t]=e)},t.prototype.addMvcProviders=function(){var t=new a;this.addProvider("required",t.required),this.addProvider("length",t.stringLength),this.addProvider("maxlength",t.stringLength),this.addProvider("minlength",t.stringLength),this.addProvider("equalto",t.compare),this.addProvider("range",t.range),this.addProvider("regex",t.regex),this.addProvider("creditcard",t.creditcard),this.addProvider("email",t.email),this.addProvider("url",t.url),this.addProvider("phone",t.phone),this.addProvider("remote",t.remote)},t.prototype.scanMessages=function(){for(var t=document.querySelectorAll("[data-valmsg-for]"),e=0;e<t.length;e++){var r=t[e],n=r.getAttribute("data-valmsg-for");this.messageFor[n]||(this.messageFor[n]=[]),this.messageFor[n].push(r)}},t.prototype.parseDirectives=function(t){for(var e={},r={},n="data-val-".length,i=0;i<t.length;i++){var a=t[i];if(0===a.name.indexOf("data-val-")){var o=a.name.substr(n);r[o]=a.value}}for(var o in r)!function(t){if(-1===t.indexOf("-")){for(var n=Object.keys(r).filter(function(e){return e!==t&&0===e.indexOf(t)}),i={error:r[t],params:{}},a=(t+"-").length,o=0;o<n.length;o++){var s=r[n[o]],u=n[o].substr(a);i.params[u]=s}e[t]=i}}(o);return e},t.prototype.guid4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})},t.prototype.getElementUID=function(t){var e=this.elementUIDs.filter(function(e){return e.node===t})[0];if(e)return e.uid;var r=this.guid4();return this.elementUIDs.push({node:t,uid:r}),r},t.prototype.getFormValidationTask=function(t){var e=this.formInputs[t];if(!e||0===e.length)return null;for(var r=[],n=0;n<e.length;n++){var i=e[n];r.push(this.validators[i])}var a=r.map(function(t){return t()});return Promise.all(a).then(function(t){return t.every(function(t){return t})})},t.prototype.trackFormInput=function(t,e){var r=this,n=this.getElementUID(t);if(this.formInputs[n]||(this.formInputs[n]=[]),-1===this.formInputs[n].indexOf(e)&&this.formInputs[n].push(e),!this.elementEvents[n]){var i=function(t){var e=r.getFormValidationTask(n);e&&e.then(function(e){e||t.preventDefault()}).catch(function(t){console.log(t)})};t.addEventListener("submit",i),this.elementEvents[n]=i}},t.prototype.addInput=function(t){var e=this,r=this.getElementUID(t),n=this.parseDirectives(t.attributes),i=this.createValidator(t,n);if(this.validators[r]=i,this.trackFormInput(t.form,r),!this.elementEvents[r]){var a,o=function(t){var n=e.validators[r];clearTimeout(a),a=setTimeout(n,e.debounce)};"select"===t.tagName.toLowerCase()?t.addEventListener("change",o):t.addEventListener("input",o),this.elementEvents[r]=o}},t.prototype.scanInputs=function(){for(var t=document.querySelectorAll('[data-val="true"]'),e=0;e<t.length;e++){var r=t[e];this.addInput(r)}},t.prototype.createSummaryDOM=function(){if(!Object.keys(this.summary).length)return null;var t=document.createElement("ul");for(var e in this.summary){var r=document.createElement("li");r.innerHTML=this.summary[e],t.appendChild(r)}return t},t.prototype.renderSummary=function(){var t=document.querySelectorAll('[data-valmsg-summary="true"]');if(t.length){var e=JSON.stringify(this.summary,Object.keys(this.summary).sort());if(e!==this.renderedSummaryJSON){this.renderedSummaryJSON=e;for(var r=this.createSummaryDOM(),n=0;n<t.length;n++){var i=t[n];i.innerHTML="",r?(i.className="validation-summary-error",i.appendChild(r.cloneNode(!0))):i.className="validation-summary-valid"}}}},t.prototype.addError=function(t,e){var r=this.messageFor[t.id];if(r)for(var n=0;n<r.length;n++)r[n].innerHTML=e,r[n].className="field-validation-error";t.classList.remove("input-validation-valid"),t.classList.add("input-validation-error");var i=this.getElementUID(t);this.summary[i]=e,this.renderSummary()},t.prototype.removeError=function(t){var e=this.messageFor[t.id];if(e)for(var r=0;r<e.length;r++)e[r].innerHTML="",e[r].className="field-validation-valid";t.classList.remove("input-validation-error"),t.classList.add("input-validation-valid");var n=this.getElementUID(t);delete this.summary[n],this.renderSummary()},t.prototype.createValidator=function(t,e){var r=this;return function(){return n(r,void 0,void 0,function(){var r,n,a,o,s,u,d,f,l,c;return i(this,function(i){switch(i.label){case 0:r=[];for(n in e)r.push(n);a=0,i.label=1;case 1:return a<r.length?(o=r[a],s=e[o],(u=this.providers[o])?(d=u(t.value,t,s.params),f=!1,l=s.error,"boolean"!=typeof d?[3,2]:(f=d,[3,5])):(console.log("aspnet-validation provider not implemented: "+o),[3,6])):[3,7];case 2:return"string"!=typeof d?[3,3]:(f=!1,l=d,[3,5]);case 3:return[4,d];case 4:c=i.sent(),"boolean"==typeof c?f=c:(f=!1,l=c),i.label=5;case 5:if(!f)return this.addError(t,l),[2,!1];i.label=6;case 6:return a++,[3,1];case 7:return this.removeError(t),[2,!0]}})})}},t.prototype.bootstrap=function(){var t=this;this.addMvcProviders(),document.addEventListener("DOMContentLoaded",function(e){t.scanMessages(),t.scanInputs()})},t}()}])});
//# sourceMappingURL=aspnet-validation.min.js.map